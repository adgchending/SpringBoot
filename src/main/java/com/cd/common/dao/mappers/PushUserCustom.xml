<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.cd.common.dao.PushUserCustomDao">

    <select id="selectPushUser" resultType="com.cd.common.pojo.domain.PushUser">
        SELECT
        Spu.FK_CODE AS fkCode,
        Spu.CREATE_TIME AS createTime,
        Spu.UPDATE_TIME AS updateTime,
        Spu.SCHOOL_FK_CODE AS schoolFkCode,
        Spu.USER_FK_CODE AS userFkCode,
        Spu.USER_NAME AS userName,
        Spu.FACILITY_TYPE AS facilityType,
        Spu.FACILITY_IDENTITY AS facilityIdentity
        FROM Sys_Push_User AS Spu
        WHERE USER_FK_CODE = #{userFkCode}
    </select>

    <insert id="registerPushUser">
        INSERT INTO Sys_Push_User (CREATE_TIME,UPDATE_TIME,FK_CODE,DEL_STATUS,SCHOOL_FK_CODE,USER_FK_CODE,USER_NAME,FACILITY_TYPE,FACILITY_IDENTITY)
        VALUES (NOW(),NOW(),#{fkCode},0,#{form.schoolFkCode},#{form.userFkCode},#{form.userName},#{form.facilityType},#{form.clientId})
    </insert>

    <update id="updatePushUser">
        UPDATE Sys_Push_User SET
        UPDATE_TIME = NOW(),
        USER_NAME = #{form.userName},
        FACILITY_TYPE = #{form.facilityType},
        FACILITY_IDENTITY = #{form.clientId}
        WHERE USER_FK_CODE = #{form.userFkCode} and SCHOOL_FK_CODE = #{form.schoolFkCode}
    </update>
</mapper>
